{"version":3,"file":"ajustes.component.js","sourceRoot":"","sources":["ajustes.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component } from 'angular2/core';\r\nimport { MenuComponent } from './menu.component';\r\nimport { SeleccionComponent } from './seleccion.component';\r\nimport { UsuarioService } from './usuario.service';\r\nimport { OnInit } from 'angular2/core';\r\nimport { Usuario } from './usuario.model';\r\nimport { RouteParams } from 'angular2/router';\r\nimport { SesionService } from './sesion.service';\r\nimport {HTTP_PROVIDERS, Http} from 'angular2/http';\r\nimport {MultipartItem} from \"./multipart-item\";\r\nimport {MultipartUploader} from \"./multipart-uploader\";\r\n\r\n@Component({\r\n  selector: 'ajustes-component',\r\n  templateUrl: 'app/ajustes.component.html',\r\n  directives: [MenuComponent, SeleccionComponent],\r\n  providers: [UsuarioService, SesionService]\r\n})\r\n\r\nexport class AjustesComponent  implements OnInit {\r\n  //Variables\r\n  usuario: Usuario;\r\n  actual: string;\r\n  visible: boolean = false;\r\n  datos: boolean = false;\r\n  descripcion:string;\r\n  img_perfil:File;\r\n  auxid:number;\r\n\r\n  //Metodos\r\n  constructor(private http: Http, private _usuarioService: UsuarioService, private _routeParams: RouteParams, private _sesionService: SesionService) {}\r\n  ngOnInit() {\r\n    let id= +this._routeParams.get('id');\r\n    this._usuarioService.getUsuario(id).subscribe(usuario =>{\r\n      this.usuario = usuario;\r\n      this._sesionService.getSesion().then(actual =>{\r\n        this.actual = actual.usuario;\r\n        this.visible = true;\r\n      });\r\n    })\r\n  }\r\n\r\n  //METODOS PARA IMAGENES\r\n  loadImages(){\r\n\t\treturn this.http.get(\"/images\").map(\r\n\t\t\tresponse => response.json()\r\n    )\r\n\t}\r\n\r\n  buscarImage(id:number){\r\n    return this.http.get(\"/image/\"+id).map(\r\n\t\t\tresponse => response.json()\r\n    )\r\n  }\r\n\r\n  selectFile($event) {\r\n      this.img_perfil = $event.target.files[0];\r\n  \t\tconsole.debug(\"Selected file: \" + this.img_perfil.name + \" type:\" + this.img_perfil.size + \" size:\" + this.img_perfil.size);\r\n\t}\r\n\r\n  upload() {\r\n\t\tconsole.debug(\"Uploading file...\");\r\n    this.descripcion = \"perfil\";\r\n\t\tif (this.img_perfil == null || this.descripcion == null){\r\n\t\t\tconsole.error(\"You have to select a file and set a description.\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet formData = new FormData();\r\n\r\n\t\tformData.append(\"description\", this.descripcion);\r\n\t\tformData.append(\"file\",  this.img_perfil);\r\n\r\n\t\tlet multipartItem = new MultipartItem(new MultipartUploader({url: '/image/upload'}));\r\n\r\n\t\tmultipartItem.formData = formData;\r\n\r\n\t\tmultipartItem.callback = (data, status, headers) => {\r\n\r\n\t\t\tif (status == 200){\r\n\t\t\t\tconsole.debug(\"File has been uploaded\");\r\n\t\t\t\tthis.loadImages();\r\n\t\t\t} else {\r\n\t\t\t\tconsole.error(\"Error uploading file\");\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tmultipartItem.upload();\r\n\r\n    this.loadImages().subscribe(id =>{\r\n      console.log(id);\r\n      this.auxid = id;\r\n    })\r\n\r\n }\r\n\r\n guardarImg(){\r\n   this.buscarImage(this.auxid).subscribe(image =>{\r\n     this.usuario.imagen=image;\r\n     this.guardarDatosP();\r\n     console.log(this.usuario.imagen);\r\n   })\r\n }\r\n\r\n notificar(campo){\r\n    if(campo == 'datos'){\r\n      this.datos = true;\r\n    }\r\n  }\r\n  noNotificar(campo){\r\n    if(campo == 'datos'){\r\n      this.datos = false;\r\n    }\r\n  }\r\n  guardarDatosP(){\r\n    this._usuarioService.setPersonales(this.usuario).subscribe(usuario => console.log(usuario));\r\n  }\r\n  cambiaEstado(estado: boolean, sitio: string){\r\n    if(sitio == 'perfil'){\r\n      this.usuario.pPerfilTodos = estado;\r\n      this._usuarioService.setPrivacidad(this.usuario).subscribe(usuario => console.log(usuario));\r\n    }\r\n    if(sitio == 'contenido'){\r\n      this.usuario.cPerfilTodos = estado;\r\n      this._usuarioService.setPrivacidad(this.usuario).subscribe(usuario => console.log(\"Hola\"));\r\n    }\r\n    if(sitio == 'amigos'){\r\n      this.usuario.aPerfilTodos = estado;\r\n      this._usuarioService.setPrivacidad(this.usuario).subscribe(usuario => console.log(\"Hola\"));\r\n    }\r\n  }\r\n}\r\n"]}
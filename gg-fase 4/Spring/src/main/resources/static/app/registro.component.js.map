{"version":3,"file":"registro.component.js","sourceRoot":"","sources":["registro.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component,Input } from 'angular2/core';\nimport { Usuario } from './usuario.model';\nimport { UsuarioService } from './usuario.service';\nimport {Image} from './image.model';\nimport {Prod} from './clases';\nimport {MultipartItem} from \"./multipart-item\";\nimport {MultipartUploader} from \"./multipart-uploader\";\nimport { Router } from 'angular2/router';\nimport {HTTP_PROVIDERS, Http} from 'angular2/http';\n\n@Component({\n  selector: 'registro-component',\n  templateUrl: 'app/registro.component.html'\n})\n\nexport class registrar {\n  //Variables\n  correo: string;\n  usuario: string;\n  contrasena: string;\n  contrasena2: string;\n  nuevo_usuario: Usuario;\n  boton: boolean = false;\n  error: boolean = false;\n  registrado: boolean = false;\n  img:Image;\n  img_perfil:File;\n  descripcion: string;\n  auxid:number;\n  coleccion: Prod[];\n  amigos: Usuario[];\n\n  //MÃ©todos\n  constructor (private http: Http, private _usuarioService: UsuarioService, private router: Router){}\n\n  //METODOS PARA IMAGENES\n  loadImages(){\n\t\treturn this.http.get(\"/images\").map(\n\t\t\tresponse => response.json()\n    )\n\t}\n\n  buscarImage(id:number){\n    return this.http.get(\"/image/\"+id).map(\n\t\t\tresponse => response.json()\n    )\n  }\n\n  selectFile($event) {\n      this.img_perfil = $event.target.files[0];\n  \t\tconsole.debug(\"Selected file: \" + this.img_perfil.name + \" type:\" + this.img_perfil.size + \" size:\" + this.img_perfil.size);\n\t}\n\n  upload() {\n\t\tconsole.debug(\"Uploading file...\");\n    this.descripcion = \"perfil\";\n\t\tif (this.img_perfil == null || this.descripcion == null){\n\t\t\tconsole.error(\"You have to select a file and set a description.\");\n\t\t\treturn;\n\t\t}\n\n\t\tlet formData = new FormData();\n\n\t\tformData.append(\"description\", this.descripcion);\n\t\tformData.append(\"file\",  this.img_perfil);\n\n\t\tlet multipartItem = new MultipartItem(new MultipartUploader({url: '/image/upload'}));\n\n\t\tmultipartItem.formData = formData;\n\n\t\tmultipartItem.callback = (data, status, headers) => {\n\n\t\t\tif (status == 200){\n\t\t\t\tconsole.debug(\"File has been uploaded\");\n\t\t\t\tthis.loadImages();\n\t\t\t} else {\n\t\t\t\tconsole.error(\"Error uploading file\");\n\t\t\t}\n\t\t};\n\n\t\tmultipartItem.upload();\n\n    this.loadImages().subscribe(id =>{\n      this.auxid=id;\n      console.log(this.auxid);\n    })\n\n }\n\n  registrar(){\n    this.buscarImage(this.auxid).subscribe(image => {\n      this.img=image\n      this.nuevo_usuario = {\n        nombre: \"\",\n        apellidos: \"\",\n        nacionalidad: \"\",\n        cumpleanos: \"\",\n        roles: ['ROLE_USER'],\n        usuario: this.usuario,\n        contrasena: this.contrasena,\n        correo: this.correo,\n        imagen: this.img,\n        nAmigos: 0,\n        nPelis: 0,\n        nSeries: 0,\n        nJuegos: 0,\n        ultima: \"hoy\",\n        tUsuario: \"hoy\",\n        fPeli: null,\n        fSerie: null,\n        fJuego: null,\n        pPerfilTodos: true,\n        cPerfilTodos: true,\n        aPerfilTodos: true,\n        coleccion: this.coleccion,\n        amigos: this.amigos\n      }\n      this._usuarioService.addUsuario(this.nuevo_usuario).subscribe(usr => this.gotoHome());\n      this.registrado = true;\n    })\n  }\n\n  gotoHome(){\n    let link = ['Home'];\n    this.router.navigate(link);\n  }\n}\n"]}